# æ–‡æ¡£ç›®å½•è¯´æ˜


## æ¨èç›®å½•ç»“æ„

```text
docs/
â”œâ”€â”€ requirements/          # éœ€æ±‚æ–‡æ¡£ï¼ˆPRDï¼‰
â”œâ”€â”€ tdd/                   # æŠ€æœ¯è®¾è®¡æ–‡æ¡£ï¼ˆHLD/æ¶æ„çº§ï¼‰
â”‚   â”œâ”€â”€ hld-ios-macos-v0.2.md
â”‚   â””â”€â”€ ...
â”œâ”€â”€ adr/                   # æ¶æ„å†³ç­–è®°å½•
â”‚   â”œâ”€â”€ template.md
â”‚   â”œâ”€â”€ 001-di-strategy.md
â”‚   â””â”€â”€ ...
â”œâ”€â”€ scrum/                 # Scrum è¿‡ç¨‹æ–‡æ¡£
â”‚   â”œâ”€â”€ sprint-plan-v0.2-updated.md
â”‚   â”œâ”€â”€ reviews/
â”‚   â””â”€â”€ tasks/            # ğŸ‘ˆ æ–°å¢ï¼šSprint Task è¯¦ç»†è®¾è®¡
â”‚       â”œâ”€â”€ sprint-0/
â”‚       â”‚   â”œâ”€â”€ task-001-repo-init.md
â”‚       â”‚   â””â”€â”€ task-002-ci-setup.md
â”‚       â”œâ”€â”€ sprint-1/
â”‚       â”‚   â”œâ”€â”€ task-101-player-service.md
â”‚       â”‚   â”œâ”€â”€ task-102-asr-engine-protocol.md
â”‚       â”‚   â””â”€â”€ ...
â”‚       â”œâ”€â”€ sprint-2/
â”‚       â””â”€â”€ sprint-3/
â””â”€â”€ Prism-xOS/
```

## è®¾è®¡æ–‡æ¡£åˆ†ç±»åŸåˆ™

| æ–‡æ¡£ç±»å‹ | ç›®å½•ä½ç½® | ç²’åº¦ | ç”Ÿå‘½å‘¨æœŸ |
|---------|---------|------|---------|
| **PRD** | requirements | äº§å“åŠŸèƒ½çº§ | é•¿æœŸç»´æŠ¤ï¼ˆç‰ˆæœ¬åŒ–ï¼‰ |
| **HLD/TDD** | tdd | æ¶æ„/æ¨¡å—çº§ | é•¿æœŸç»´æŠ¤ï¼ˆç‰ˆæœ¬åŒ–ï¼‰ |
| **ADR** | `docs/adr/` | å…³é”®æŠ€æœ¯å†³ç­– | æ°¸ä¹…ä¿ç•™ï¼ˆä¸å¯å˜ï¼‰ |
| **Task Design** | `docs/scrum/tasks/sprint-N/` | å®ç°ä»»åŠ¡çº§ | Sprint å‘¨æœŸå†…æœ‰æ•ˆ |

## Task è®¾è®¡æ–‡æ¡£æ¨¡æ¿ç¤ºä¾‹

````markdown
# Task-102: AsrEngine åè®®å®šä¹‰ä¸ WhisperCpp åç«¯å®ç°

## ä»»åŠ¡ä¿¡æ¯
- **Sprint**: Sprint 1
- **PBI**: AsrEngine åè®®å®šä¹‰ä¸ WhisperCppBackendï¼ˆ5 SPï¼‰
- **è´Ÿè´£äºº**: @developer-name
- **çŠ¶æ€**: In Progress / Review / Done
- **ç›¸å…³æ–‡ä»¶**:
  - `packages/PrismASR/Sources/AsrEngine.swift`
  - `packages/PrismASR/Sources/WhisperCppBackend.swift`
  - `packages/PrismASR/Tests/AsrEngineTests.swift`

## è®¾è®¡ç›®æ ‡
å®ç° AsrEngine åè®®æŠ½è±¡ï¼Œå®Œæˆ whisper.cpp åç«¯é›†æˆï¼Œæ”¯æŒ gguf æ¨¡å‹åŠ è½½ä¸ç¦»çº¿æ¨ç†ã€‚

## æŠ€æœ¯æ–¹æ¡ˆ

### 1. åè®®å®šä¹‰
```swift
// filepath: packages/PrismASR/Sources/AsrEngine.swift
public protocol AsrEngine {
    func transcribe(
        audioData: Data,
        options: AsrOptions
    ) async throws -> [AsrSegment]
}

public struct AsrOptions {
    let language: AsrLanguage?
    let enableTimestamps: Bool
    // ...
}
```

### 2. Whisper.cpp é›†æˆç­–ç•¥
- ä½¿ç”¨ SPM åŒ…è£…æˆ–ç›´æ¥ä¾èµ–
- Metal/Accelerate åç«¯è‡ªåŠ¨é€‰æ‹©
- æ¨¡å‹è·¯å¾„ä¸åŠ è½½ç­–ç•¥

### 3. æµ‹è¯•ç­–ç•¥
- åè®®å¥‘çº¦æµ‹è¯•ï¼ˆMock Backendï¼‰
- é‡‘æ ·æœ¬å›å½’ï¼ˆ3 æ®µéŸ³é¢‘ Ã— 10-30sï¼‰
- æ€§èƒ½åŸºçº¿è®°å½•

## éªŒæ”¶æ ‡å‡† (AC)
- [ ] AsrEngine åè®®å®šä¹‰å®Œæˆ
- [ ] WhisperCppBackend å®ç°é€šè¿‡å•æµ‹
- [ ] é‡‘æ ·æœ¬ WER < 15%
- [ ] æ–‡æ¡£ä¸ç¤ºä¾‹ä»£ç å®Œæ•´

## ä¾èµ–ä¸é£é™©
- whisper.cpp ç‰ˆæœ¬é”å®š
- Metal å…¼å®¹æ€§æµ‹è¯•ï¼ˆiOS 17+ / macOS 14+ï¼‰

## å‚è€ƒ
- HLD Â§6.1/Â§6.2
- whisper.cpp å®˜æ–¹æ–‡æ¡£
````

## å…³é”®åŸåˆ™

1. **åˆ†å±‚è®¾è®¡**ï¼š
   - HLD å®šä¹‰"æ˜¯ä»€ä¹ˆ"ï¼ˆåè®®ã€æ¶æ„ï¼‰
   - Task è®¾è®¡å®šä¹‰"æ€ä¹ˆåš"ï¼ˆå…·ä½“å®ç°ç»†èŠ‚ï¼‰

2. **å¯è¿½æº¯æ€§**ï¼š
   - Task è®¾è®¡å¿…é¡»å…³è” PBI ä¸ Sprint
   - å¼•ç”¨ HLD/PRD ç« èŠ‚å·

3. **ç”Ÿå‘½å‘¨æœŸç®¡ç†**ï¼š
   - Task è®¾è®¡åœ¨ Sprint ç»“æŸåå¯å½’æ¡£
   - å…³é”®æŠ€æœ¯å†³ç­–æå–ä¸º ADRï¼ˆæ°¸ä¹…ä¿ç•™ï¼‰
   - é€šç”¨è®¾è®¡æ–¹æ¡ˆåˆå¹¶å› HLDï¼ˆé•¿æœŸç»´æŠ¤ï¼‰

4. **æ–‡ä»¶å‘½åè§„èŒƒ**ï¼š
   - `task-<ç¼–å·>-<ç®€çŸ­æè¿°>.md`
   - ç¼–å·å¯é‡‡ç”¨ `<sprint>-<åºå·>` æ ¼å¼ï¼ˆå¦‚ `task-102` = Sprint 1 çš„ç¬¬ 2 ä¸ªä»»åŠ¡ï¼‰

è¿™æ ·å¯ä»¥ä¿æŒæ–‡æ¡£æ¸…æ™°åˆ†å±‚ï¼ŒåŒæ—¶æ”¯æŒæ•æ·è¿­ä»£è¿‡ç¨‹ä¸­çš„è¯¦ç»†è®¾è®¡è®°å½•ã€‚