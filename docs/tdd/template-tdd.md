# 技术设计文档（TDD）模板

- 版本：vX.Y
- 适用范围：iOS / Android / 跨端
- 维护人：@
- 最后更新：YYYY-MM-DD
- 关联 ADR：
  - ADR-000X 标题（链接）— 状态：Accepted — 摘要：一句话影响
  - ADR-000Y 标题（链接）— 状态：Proposed — 摘要：一句话影响
- 关联 PRD：`docs/requirements/prd_vX.Y.md`

## 1. 背景与目标
- 背景：
- 目标（可量化）：
- 范围 / 非目标：
- 约束与前提：平台/法规/硬件/既有架构

## 2. 需求与用例
- 功能需求、非功能需求（性能/能耗/可靠性/可维护性）
- 关键用例/用户旅程、边界与异常用例

## 3. 架构总览
- 方案对比与取舍要点（链接到 ADR）
- 逻辑架构图/流程图/时序图/状态机

## 4. 模块与数据设计
- 模块边界与职责、交互关系、MVVM 映射（SwiftUI/Compose）
- 数据模型、存储设计（模式、索引、迁移策略）
- 关键算法与核心流程（例如离线 ASR 管线、字幕时间同步）

## 5. 接口与集成
- 内部接口（协议/接口定义、错误语义、幂等/重试）
- 外部依赖与库版本、平台能力与权限（音频会话、后台执行）

## 6. 质量与保障
- 可观测性（日志、指标、追踪）、告警与仪表盘
- 性能与容量评估（目标 QPS/吞吐、延迟、内存/CPU/能耗预算）
- 安全与隐私（数据分类、加密、权限）、合规与许可证
- 国际化与本地化策略（避免硬编码字符串）

## 7. 测试与验证
- 测试金字塔（单测/集成/E2E/回归）、测试数据与夹具
- 验收标准、灰度与特性开关

## 8. 交付与运维
- 发布/回滚策略、迁移计划、兼容性（前后向）
- 运维流程与日常操作

## 9. 风险与未决事项
- 风险清单与缓解策略
- 未决问题与跟进计划

## 10. 里程碑与估算
- 版本切片、时间线、依赖关系

## 附录
- 术语表、参考资料、链接索引（含 ADR 索引）
